<div align="center">
<h1>Keil Assistant</h1>

![LOGO](res/icons/icon.png)
 
[![Visual Studio Marketplace Version (including pre-releases)](https://img.shields.io/visual-studio-marketplace/v/jacksonjim.keil-vscode-assistant?logo=visualstudiocode)](https:/github.com/jacksonjim/keil-assistant)
[![GitHub release (with filter)](https://img.shields.io/github/v/release/jacksonjim/keil-assistant?display_name=release&logo=github)](https:/github.com/jacksonjim/keil-assistant)
<!-- [![Build Linux & Windows](https:/github.com/jacksonjim/keil-assistant/workflows/Build%20vsce%20package/badge.svg)](https:/github.com/jacksonjim/keil-assistant) -->
[![GitHub Actions Workflow Status](https://img.shields.io/github/actions/workflow/status/jacksonjim/keil-assistant/vsce-package.yml?logo=github&label=Build%20vsce%20package)](https:/github.com/jacksonjim/keil-assistant)


</div>

---
## [EnglishğŸ“„](./README_EN.md)
---

## ç®€è¿° ğŸ“‘

vscode ä¸Šçš„ Keil è¾…åŠ©å·¥å…·ï¼Œä¸ c/c++ æ’ä»¶é…åˆä½¿ç”¨.

èƒ½å¤Ÿä¸º Keil é¡¹ç›®æä¾› è¯­æ³•é«˜äº®ã€ä»£ç ç‰‡æ®µ çš„åŠŸèƒ½ï¼Œå¹¶æ”¯æŒå¯¹ keil é¡¹ç›®è¿›è¡Œ ç¼–è¯‘ã€ä¸‹è½½ã€‚

**[å…³äºKeilåŠ©æ‰‹æ’ä»¶çš„ä¸‹è½½çš„é»˜è®¤å¿«æ·é”®æ˜¯å¦éœ€è¦è°ƒæ•´ä¸ºF8é”®æ¥åšä¸ªè°ƒæŸ¥](https:/github.com/jacksonjim/keil-assistant/discussions/20)**

**ä»…æ”¯æŒ Keil uVison 5 åŠä»¥ä¸Šç‰ˆæœ¬**

**ä»…æ”¯æŒ Windows å¹³å°**

![preview](./res/preview/preview.png)

---

## åŠŸèƒ½ç‰¹æ€§ ğŸ‰

- åŠ è½½ Keil C51/C251/ARM é¡¹ç›®ï¼Œå¹¶ä»¥ Keil é¡¹ç›®èµ„æºç®¡ç†å™¨çš„å±•ç¤ºæ–¹å¼æ˜¾ç¤ºé¡¹ç›®è§†å›¾
- è‡ªåŠ¨ç›‘è§† keil é¡¹ç›®æ–‡ä»¶çš„å˜åŒ–ï¼ŒåŠæ—¶æ›´æ–°é¡¹ç›®è§†å›¾
- é€šè¿‡è°ƒç”¨ Keil å‘½ä»¤è¡Œæ¥å£å®ç° ç¼–è¯‘ï¼Œé‡æ–°ç¼–è¯‘ï¼Œçƒ§å½• keil é¡¹ç›®
- è‡ªåŠ¨ç”Ÿæˆ c_cpp_properties.json æ–‡ä»¶ï¼Œä½¿ C/C++ æ’ä»¶çš„è¯­æ³•åˆ†æèƒ½æ­£å¸¸è¿›è¡Œ
- æ”¯æŒè°ƒç”¨å‘½ä»¤ç”Ÿæˆ compile_commands.jsonï¼ˆå¿«æ·é”®`ctrl+shift+p`, æœç´¢`ç”Ÿæˆcompile_commands.json(ä»…MDK)`ï¼‰

---
## ä¸‹è½½ğŸ“Œ
 [ Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=jacksonjim.keil-vscode-assistant)
---

## ç”¨æ³• ğŸ“–

### å‡†å¤‡å·¥ä½œ

1. å®‰è£… C/C++ æ’ä»¶

2. è¿›å…¥ Keil-Assistant æ’ä»¶è®¾ç½®ï¼Œ~~è®¾ç½®å¥½ keil å¯æ‰§è¡Œæ–‡ä»¶ UV4.exe çš„ç»å¯¹è·¯å¾„~~ 
- v1.7.2 ä»¥å‰çš„é…ç½®ä¿æŒä¸å˜
  
  ![setting](./res/preview/setting.png)

- v1.7.3+ ç‰ˆæœ¬å¼€å§‹åªéœ€è¦é…ç½®Keilå®‰è£…ç›®å½•å³å¯ï¼Œç®€åŒ–ç›¸å…³é…ç½®é¡¹ç›®(é»˜è®¤ç›®å½•ä¸º:C:\Keil_v5)

- v1.8.0+ ç‰ˆæœ¬æ–¹ä¾¿éƒ¨åˆ†ç”¨æˆ·éœ€è¦å•ç‹¬è®¾ç½®C51æˆ–C251å®‰è£…ç›®å½•å¢åŠ ä¸€ä¸ªå¯é€‰é¡¹è®¾ç½®ï¼Œé»˜è®¤åªéœ€è¦è®¾ç½®MDKçš„å®‰è£…ç›®å½•å³å¯ï¼Œä»…æ”¯æŒ: MDK, C51, C251; è¯¦æƒ…å‚è€ƒè®¾ç½®ä¸­æœ‰ç¤ºä¾‹
  
  ![setting](./res/preview/new_setting.png)

- v1.9.3+ ç‰ˆæœ¬âš ï¸è°ƒæ•´æ”¯æŒæœ€ä½vscode enginesçš„ç‰ˆæœ¬ä¸º V1.73.0+çš„VsCode, éº»çƒ¦è¯·æ›´æ–°ä¸ºV1.73.0åçš„ç‰ˆæœ¬,æ­¤æ¬¡è°ƒæ•´å› ä¸ºå¤šè¯­è¨€ç‰ˆæœ¬æœ€ä½æ”¯æŒçš„ç‰ˆæœ¬ä¸º1.73.0; [**l10n** æ­¤APIåœ¨VS Code 1.73 ä¸­å¼•å…¥](https://github.com/microsoft/vscode-l10n/blob/main/README.md)

---


### å¼€å§‹ä½¿ç”¨ ğŸƒâ€â™€ï¸

1. åœ¨ Keil ä¸Šåˆ›å»ºå¥½é¡¹ç›®ï¼Œæ·»åŠ å¥½æ–‡ä»¶ï¼Œå¤´æ–‡ä»¶è·¯å¾„ç­‰, æˆ–æ˜¯ä½¿ç”¨å…¶å®ƒå·¥å…·[STM32cubemx]ç”Ÿæˆkeil é¡¹ç›®æ–‡ä»¶

2. ç‚¹å‡» **æ‰“å¼€é¡¹ç›®** å›¾æ ‡ æˆ–è€… **ä½¿ç”¨ vscode ç›´æ¥æ‰“å¼€ keil é¡¹ç›®æ–‡ä»¶(.uvproj) æ‰€åœ¨çš„ç›®å½•**ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨åŠ è½½ keil é¡¹ç›®;
   
  - æ‰“å¼€*.uvprojé¡¹ç›®æ–‡ä»¶
  
    ![load](./res/preview/load.png)

  - å¿«æ·æ‰“å¼€é¡¹ç›®æ–¹å¼1  **å³å‡»é¡¹ç›®æ ¹æ–‡ä»¶å¤¹ --> é€šè¿‡vscodeæ‰“å¼€**
    
    ![load](./res/preview/load1.png)
  
  - å¿«æ·æ‰“å¼€é¡¹ç›®æ–¹å¼2  **åœ¨vscodeä¸­--> æ–‡ä»¶--æ‰“å¼€æ–‡ä»¶å¤¹(å¿«æ·é”®ï¼šCtrl+k Ctrl+O), é€‰æ‹©é¡¹ç›®æ‰€åœ¨çš„ç›®å½•**
    ![load](./res/preview/load2.png)
    ![load](./res/preview/load3.png)

### å¸¸ç”¨æ“ä½œ

- **ç¼–è¯‘(F7)ï¼Œçƒ§å½•(F8)**ï¼šæä¾›äº† 3 ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«ä»£è¡¨ ç¼–è¯‘ï¼Œä¸‹è½½ï¼Œé‡æ–°ç¼–è¯‘

  ![build](./res/preview/build.png)


- **ä¿å­˜å’Œåˆ·æ–°**ï¼šåœ¨ Keil ä¸Šæ·»åŠ /åˆ é™¤æºæ–‡ä»¶ï¼Œæ›´æ”¹ï¼Œé…ç½®é¡¹ç›®ï¼Œæ›´æ”¹å®Œæ¯•åç‚¹å‡» **ä¿å­˜æ‰€æœ‰**ï¼Œæ’ä»¶æ£€æµ‹åˆ° keil é¡¹ç›®å˜åŒ–åä¼šè‡ªåŠ¨åˆ·æ–°é¡¹ç›®

  ![keil_save_all](./res/preview/keil_save_all.png)


- **æ‰“å¼€æºæ–‡ä»¶**ï¼šå•å‡»æºæ–‡ä»¶å°†ä»¥é¢„è§ˆæ¨¡å¼æ‰“å¼€ï¼ŒåŒå‡»æºæ–‡ä»¶å°†åˆ‡æ¢åˆ°éé¢„è§ˆæ¨¡å¼æ‰“å¼€

  ![open_file](./res/preview/open_file.png)


- **åˆ‡æ¢ c/c++ æ’ä»¶çš„é…ç½®**ï¼šç‚¹å‡»ç›®æ ‡åç§°åœ¨å¤šä¸ª c/c++ é…ç½®ä¸­åˆ‡æ¢

  ![cpp_config](./res/preview/cpp_config.png)


- **åˆ‡æ¢ keil Target(CTRL+T)**ï¼šç‚¹å‡»é¡¹ç›®çš„åˆ‡æ¢æŒ‰é’®ï¼Œå¯ä»¥åœ¨å¤šä¸ª Keil Target ä¹‹é—´åˆ‡æ¢

  ![active_target](./res/preview/switch_target.png)


- **å±•å¼€å¼•ç”¨**ï¼šåœ¨ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥ç‚¹å‡»æºæ–‡ä»¶é¡¹çš„ç®­å¤´å›¾æ ‡å±•å¼€å…¶å¼•ç”¨ï¼ˆä»…æ”¯æŒ ARM é¡¹ç›®ï¼‰

  ![show_referance](./res/preview/ref_show.png)

---

### å…¶ä»–è®¾ç½®

- å·¥ä½œåŒºè®¾ç½®ï¼šé¡¹ç›®æ’é™¤åˆ—è¡¨(`KeilAssistant.Project.ExcludeList`)
  å½“æŸä¸ªç›®å½•ä¸‹å­˜åœ¨å¤šä¸ª keil é¡¹ç›®æ—¶ï¼Œä½¿ç”¨æ’ä»¶æ‰“å¼€è¯¥ç›®å½•ï¼Œæ’ä»¶ä¼šåŠ è½½æ‰€æœ‰çš„ keil é¡¹ç›®ï¼Œé€šè¿‡æ­¤é€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šéœ€è¦æ’é™¤å“ªäº› keil é¡¹ç›®ï¼Œé˜²æ­¢åœ¨æ‰“å¼€è¯¥å·¥ä½œåŒºæ—¶è‡ªåŠ¨åŠ è½½è¯¥é¡¹ç›®
  **é»˜è®¤çš„æ’é™¤åˆ—è¡¨**ï¼š
  ```json
  ["template.uvproj", "template.uvprojx"]
  ```

### å…³äº C51/C251 çš„ä¸­æ–­æç¤ºé—®é¢˜

- åœ¨ä»£ç å¤´æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç æ›¿æ¢ï¼Œå³å¯
- C51 ä»£ç éƒ¨åˆ†

```c
#ifndef __VSCODE_C51__
#define INTERRUPT(x) interrupt x
#else
#define INTERRUPT(x)
#endif
```

- C251 ä»£ç éƒ¨åˆ†

```c
#ifndef __VSCODE_C251__
#define INTERRUPT(x) interrupt x
#else
#define INTERRUPT(x)
#endif

```

- ç¤ºä¾‹ä»£ç ä½¿ç”¨

```c
void UART1_int(void) INTERRUPT(UART1_VECTOR)
{
    if (RI)
    {
      RI = 0;
    }

    if (TI)
    {
      TI = 0;
    }
}
```

### è¿˜æœ‰å…¶ä»–é—®é¢˜ ï¼Ÿ

å¯ä»¥åˆ°ä»¥ä¸‹ä½ç½®è¿›è¡Œäº¤æµ

- [è®ºå›: https://discuss.em-ide.com/t/keil-assistant](https://discuss.em-ide.com/t/keil-assistant)

- [Github Issue: https:/github.com/jacksonjim/keil-assistant/issues](https:/github.com/jacksonjim/keil-assistant/issues)
